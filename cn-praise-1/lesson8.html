<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>8ê³¼. ë‚˜ëŠ” ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì •í–ˆì–´ìš” Â· æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
      background: #f7f9fc;
      font-size: 24px;
      color: #111;
    }
    h1 {
      font-size: 40px;
      margin-bottom: 16px;
      color: #000;
    }

    /* ìƒë‹¨ í° íƒ­ (1~6) */
    .step-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 16px;
    }
    .step-tab {
      width: 48px;
      height: 48px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #fed7aa;
      font-size: 22px;
      color: #7c2d12;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .step-tab.active {
      background: #f97316;
      color: #fff;
      box-shadow: 0 0 0 2px #ffedd5 inset;
    }

    .card {
      background: #ffffff;
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    .section-label {
      font-size: 20px;
      color: #374151;
      margin-bottom: 8px;
    }
    h2 {
      font-size: 30px;
      margin-bottom: 10px;
      color: #000;
    }

    .zh {
      font-size: 40px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #b91c1c;
    }
    .pinyin {
      font-size: 26px;
      color: #444;
      margin-bottom: 4px;
    }
    .ko {
      font-size: 26px;
      color: #222;
      margin-bottom: 10px;
      white-space: pre-line;
    }
    .hint {
      font-size: 20px;
      color: #555;
      margin-top: 6px;
    }

    button {
      padding: 10px 20px;
      font-size: 20px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      margin-right: 8px;
      margin-top: 6px;
      background: #2563eb;
      color: white;
    }
    button.secondary { background: #10b981; }
    button.ghost { background: #e5e7eb; color: #1f2937; }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      margin-bottom: 4px;
    }

    /* ë§ì”€ ì¹´ë“œ */
    .verse-card {
      background: linear-gradient(135deg, #fef3c7, #e0f2fe);
      border-left: 6px solid #f97316;
    }
    .verse-ref {
      font-size: 24px;
      color: #555;
      margin-bottom: 4px;
    }
    .verse-text {
      font-size: 26px;
      white-space: pre-line;
      color: #111;
    }

    /* ì†Œíƒ­ (íŒŒë€ ë²„íŠ¼) */
    .sub-mode-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 0 0 16px;
    }
    .sub-mode-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      font-size: 20px;
      cursor: pointer;
      background: #e5e7eb;
      color: #111827;
    }
    .sub-mode-btn.active {
      background: #2563eb;
      color: #fff;
    }

    /* í”Œë˜ì‹œ ì¹´ë“œ */
    .flash-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-bottom: 12px;
    }
    .flashcard {
      min-height: 220px;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #ffedd5, #fed7aa);
      border-radius: 20px;
      cursor: pointer;
      text-align: center;
      padding: 24px;
      position: relative;
      transition: background 0.25s ease;
    }
    .flashcard.back {
      background: linear-gradient(135deg, #ecfdf5, #a5f3fc);
    }
    .flash-face {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
    }
    .flash-counter {
      position: absolute;
      top: 10px;
      left: 14px;
      font-size: 18px;
      color: #374151;
      background: rgba(255,255,255,0.8);
      padding: 2px 10px;
      border-radius: 999px;
    }
    .flash-front {
      font-size: 60px;
      font-weight: bold;
      color: #b91c1c;
    }
    .flash-back-main {
      font-size: 34px;
      font-weight: bold;
      color: #000;
      margin-bottom: 6px;
    }
    .flash-back-sub {
      font-size: 24px;
      color: #333;
    }
    .idx-text {
      font-size: 20px;
      margin-top: 6px;
      color: #444;
      text-align: center;
    }
    .arrow-btn {
      width: 48px;
      height: 48px;
      border-radius: 999px;
      border: none;
      background: #e5e7eb;
      font-size: 26px;
      color: #374151;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    /* í•˜ì´ë¼ì´íŠ¸ A/B */
    .inline-a {
      background: #fef08a;
      padding: 0 4px;
      border-radius: 6px;
      box-shadow: 0 0 0 2px #fef08a inset;
    }
    .inline-b {
      background: #bbf7d0;
      padding: 0 4px;
      border-radius: 6px;
      box-shadow: 0 0 0 2px #86efac inset;
    }

    /* ë¯¸ë‹ˆ ì¹´ë“œ (A/B ì„ íƒ) */
    .mini-card-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }
    .mini-card {
      border-radius: 14px;
      padding: 10px 14px;
      min-width: 150px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(15,23,42,0.12);
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }
    .mini-card-a {
      background: #fef08a;
    }
    .mini-card-b {
      background: #dcfce7;
    }
    .mini-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15,23,42,0.16);
      filter: brightness(1.03);
    }
    .mini-card-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 4px;
      color: #111827;
    }
    .mini-card-zh {
      font-size: 26px;
      color: #b91c1c;
      margin-bottom: 2px;
    }
    .mini-card-sub {
      font-size: 18px;
      color: #4b5563;
    }

    .template-box {
      background:#e0f2fe;
      padding:12px 16px;
      border-radius:12px;
      margin-bottom:8px;
    }

    /* ë‹¨ì–´ ë§¤ì¹­ ê²Œì„ */
    .match-layout {
      display: flex;
      gap: 16px;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .match-col {
      flex: 1;
      min-width: 180px;
    }
    .match-btn {
      display: block;
      width: 100%;
      margin-bottom: 8px;
      padding: 8px 14px;
      font-size: 22px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      text-align: left;
      background: #e5e7eb;
      color: #111827;
      transition: background 0.12s ease, transform 0.12s ease;
    }
    .match-btn:hover {
      background: #d1d5db;
      transform: translateY(-1px);
    }
    .match-btn.selected {
      background: #fee2e2;
    }
    .match-btn.correct {
      background: #bbf7d0;
      cursor: default;
    }
    .match-btn.wrong {
      background: #fecaca;
    }
  </style>
</head>

<body>
  <h1>8ê³¼. ë‚˜ëŠ” ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì •í–ˆì–´ìš” Â· æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£</h1>

  <div id="step-tabs" class="step-tabs"></div>
  <div id="content"></div>

  <script>
    /* ===== 0. ê³µí†µ ìœ í‹¸ & ìŒì„± ì¬ìƒ ===== */

    function clear(el) {
      while (el.firstChild) el.removeChild(el.firstChild);
    }

    // --- ì¤‘êµ­ì–´ ìŒì„±(TTS) ---
    let zhVoices = [];
    let selectedZhVoice = null;

    function loadZhVoices() {
      if (!("speechSynthesis" in window)) return;
      const voices = window.speechSynthesis.getVoices();
      zhVoices = voices.filter(v =>
        (v.lang && v.lang.toLowerCase().startsWith("zh")) ||
        (v.lang && v.lang.toLowerCase().includes("hans")) ||
        (v.name && v.name.toLowerCase().includes("chinese"))
      );
      selectedZhVoice =
        zhVoices.find(v => v.lang && v.lang.toLowerCase() === "zh-cn") ||
        zhVoices[0] ||
        null;
    }

    if ("speechSynthesis" in window) {
      loadZhVoices();
      window.speechSynthesis.onvoiceschanged = loadZhVoices;
    }

    function ensureChineseVoice() {
      if (!("speechSynthesis" in window)) {
        alert("ë¸Œë¼ìš°ì €ê°€ ìŒì„± ì¬ìƒì„ ì§€ì›í•˜ì§€ ì•Šì•„ìš”.");
        return false;
      }
      if (!selectedZhVoice) {
        alert(
          "ì¤‘êµ­ì–´ ìŒì„±ì„ ì°¾ì§€ ëª»í–ˆì–´ìš”.\n" +
          "ê¸°ê¸° ì„¤ì •ì—ì„œ 'ì¤‘êµ­ì–´(Chinese, æ™®é€šè¯)' ìŒì„±ì„ ì¶”ê°€í•´ ì£¼ì„¸ìš”."
        );
        return false;
      }
      return true;
    }

    function speakChineseOnce(text) {
      if (!ensureChineseVoice()) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text);
      u.lang  = "zh-CN";
      u.voice = selectedZhVoice;
      u.rate  = 0.75;
      u.pitch = 1.0;
      window.speechSynthesis.speak(u);
    }

    function speakChineseFive(text) {
      if (!ensureChineseVoice()) return;
      window.speechSynthesis.cancel();
      let count = 0;
      function play() {
        const u = new SpeechSynthesisUtterance(text);
        u.lang  = "zh-CN";
        u.voice = selectedZhVoice;
        u.rate  = 0.75;
        u.pitch = 1.0;
        u.onend = () => {
          count++;
          if (count < 5) setTimeout(play, 250);
        };
        window.speechSynthesis.speak(u);
      }
      play();
    }

    /* ===== 1. pronouns8 & vocabDaily8 (ë™ì‚¬ ì‚¬ì „) ===== */

    const pronouns8 = [
      { id: "wo",    zh: "æˆ‘",   pinyin: "wÇ’",      koLabel: "ë‚˜",    koTopic: "ë‚˜ëŠ”" },
      { id: "ni",    zh: "ä½ ",   pinyin: "nÇ",      koLabel: "ë„ˆ",    koTopic: "ë„ˆëŠ”" },
      { id: "ta",    zh: "ä»–",   pinyin: "tÄ",      koLabel: "ê·¸",    koTopic: "ê·¸ëŠ”" },
      { id: "taNv",  zh: "å¥¹",   pinyin: "tÄ",      koLabel: "ê·¸ë…€",  koTopic: "ê·¸ë…€ëŠ”" },
      { id: "women", zh: "æˆ‘ä»¬", pinyin: "wÇ’men",  koLabel: "ìš°ë¦¬",  koTopic: "ìš°ë¦¬ëŠ”" },
      { id: "nimen", zh: "ä½ ä»¬", pinyin: "nÇmen",  koLabel: "ë„ˆí¬",  koTopic: "ë„ˆí¬ëŠ”" },
      { id: "tamen", zh: "ä»–ä»¬", pinyin: "tÄmen",  koLabel: "ê·¸ë“¤",  koTopic: "ê·¸ë“¤ì€" }
    ];

    // ì¼ìƒ ë™ì‚¬ + ì‹œì œ/ë¶€ì • í•œêµ­ì–´ê¹Œì§€ í¬í•¨
    const vocabDaily8 = [
      {
        id: "chi",
        hanzi: "åƒ",
        pinyin: "chÄ«",
        koBase: "ë¨¹ë‹¤",
        koPresentAffirm: "ë¨¹ì–´ìš”",
        koPastAffirm: "ë¨¹ì—ˆì–´ìš”",
        koFutureAffirm: "ë¨¹ì„ ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë¨¹ì–´ìš”",
        koPastNeg: "ì•ˆ ë¨¹ì—ˆì–´ìš”",
        koFutureNeg: "ì•ˆ ë¨¹ì„ ê±°ì˜ˆìš”"
      },
      {
        id: "he",
        hanzi: "å–",
        pinyin: "hÄ“",
        koBase: "ë§ˆì‹œë‹¤",
        koPresentAffirm: "ë§ˆì…”ìš”",
        koPastAffirm: "ë§ˆì…¨ì–´ìš”",
        koFutureAffirm: "ë§ˆì‹¤ ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë§ˆì…”ìš”",
        koPastNeg: "ì•ˆ ë§ˆì…¨ì–´ìš”",
        koFutureNeg: "ì•ˆ ë§ˆì‹¤ ê±°ì˜ˆìš”"
      },
      {
        id: "kan",
        hanzi: "çœ‹",
        pinyin: "kÃ n",
        koBase: "ë³´ë‹¤",
        koPresentAffirm: "ë´ìš”",
        koPastAffirm: "ë´¤ì–´ìš”",
        koFutureAffirm: "ë³¼ ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë´ìš”",
        koPastNeg: "ì•ˆ ë´¤ì–´ìš”",
        koFutureNeg: "ì•ˆ ë³¼ ê±°ì˜ˆìš”"
      },
      {
        id: "ting",
        hanzi: "å¬",
        pinyin: "tÄ«ng",
        koBase: "ë“£ë‹¤",
        koPresentAffirm: "ë“¤ì–´ìš”",
        koPastAffirm: "ë“¤ì—ˆì–´ìš”",
        koFutureAffirm: "ë“¤ì„ ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë“¤ì–´ìš”",
        koPastNeg: "ì•ˆ ë“¤ì—ˆì–´ìš”",
        koFutureNeg: "ì•ˆ ë“¤ì„ ê±°ì˜ˆìš”"
      },
      {
        id: "shuo",
        hanzi: "è¯´",
        pinyin: "shuÅ",
        koBase: "ë§í•˜ë‹¤",
        koPresentAffirm: "ë§í•´ìš”",
        koPastAffirm: "ë§í–ˆì–´ìš”",
        koFutureAffirm: "ë§í•  ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë§í•´ìš”",
        koPastNeg: "ì•ˆ ë§í–ˆì–´ìš”",
        koFutureNeg: "ì•ˆ ë§í•  ê±°ì˜ˆìš”"
      },
      {
        id: "mo",
        hanzi: "æ‘¸",
        pinyin: "mÅ",
        koBase: "ë§Œì§€ë‹¤",
        koPresentAffirm: "ë§Œì ¸ìš”",
        koPastAffirm: "ë§Œì¡Œì–´ìš”",
        koFutureAffirm: "ë§Œì§ˆ ê±°ì˜ˆìš”",
        koPresentNeg: "ì•ˆ ë§Œì ¸ìš”",
        koPastNeg: "ì•ˆ ë§Œì¡Œì–´ìš”",
        koFutureNeg: "ì•ˆ ë§Œì§ˆ ê±°ì˜ˆìš”"
      }
    ];

    // ì°¬ì–‘ ë‹¨ì–´ í”Œë˜ì‹œì¹´ë“œìš©
    const flashWordsSong8 = [
      { hanzi: "å·²ç»", pinyin: "yÇjÄ«ng", meaning: "ì´ë¯¸" },
      { hanzi: "å†³å®š", pinyin: "juÃ©dÃ¬ng", meaning: "ê²°ì •í•˜ë‹¤" },
      { hanzi: "è¦", pinyin: "yÃ o", meaning: "~í•˜ë ¤ í•˜ë‹¤" },
      { hanzi: "è·Ÿä»", pinyin: "gÄ“ncÃ³ng", meaning: "ë”°ë¥´ë‹¤" },
      { hanzi: "è€¶ç¨£", pinyin: "yÄ“sÅ«", meaning: "ì˜ˆìˆ˜ë‹˜" },
      { hanzi: "æ°¸", pinyin: "yÇ’ng", meaning: "ì˜ì›íˆ" },
      { hanzi: "ä¸", pinyin: "bÃ¹", meaning: "~í•˜ì§€ ì•Šë‹¤" },
      { hanzi: "å›å¤´", pinyin: "huÃ­tÃ³u", meaning: "ë’¤ëŒì•„ë³´ë‹¤" }
    ];

    // â€œë”°ë¥´ë‹¤/ì°¬ì–‘í•˜ë‹¤/ì˜ì§€í•˜ë‹¤...â€ ë‹¨ì–´
    const followVerbs8 = [
      { hanzi: "è·Ÿä»", pinyin: "gÄ“ncÃ³ng", meaning: "ë”°ë¥´ë‹¤" },
      { hanzi: "èµç¾", pinyin: "zÃ nmÄ›i", meaning: "ì°¬ì–‘í•˜ë‹¤" },
      { hanzi: "ä¾é ", pinyin: "yÄ«kÃ o", meaning: "ì˜ì§€í•˜ë‹¤" },
      { hanzi: "æ­Œé¢‚", pinyin: "gÄ“sÃ²ng", meaning: "ì°¬ì–‘í•˜ë‹¤(ë…¸ë˜í•˜ë‹¤)" },
      { hanzi: "çˆ±",   pinyin: "Ã i",     meaning: "ì‚¬ë‘í•˜ë‹¤" },
      { hanzi: "æ„Ÿè°¢", pinyin: "gÇnxiÃ¨", meaning: "ê°ì‚¬í•˜ë‹¤" }
    ];

    /* ===== 2. ë§ì”€ ë°ì´í„° ===== */

    const verses8 = [
      {
        ref: "ìš”í•œë³µìŒ 8:12",
        textKo: "ë‚˜ëŠ” ì„¸ìƒì˜ ë¹›ì´ë‹ˆ ë‚˜ë¥¼ ë”°ë¥´ëŠ” ìëŠ” ì–´ë‘ì›€ì— ë‹¤ë‹ˆì§€ ì•„ë‹ˆí•˜ê³ \nìƒëª…ì˜ ë¹›ì„ ì–»ìœ¼ë¦¬ë¼"
      },
      {
        ref: "ìš”í•œë³µìŒ 10:27",
        textKo: "ë‚´ ì–‘ì€ ë‚´ ìŒì„±ì„ ë“¤ìœ¼ë©° ë‚˜ëŠ” ê·¸ë“¤ì„ ì•Œë©° ê·¸ë“¤ì€ ë‚˜ë¥¼ ë”°ë¥´ëŠë‹ˆë¼"
      },
      {
        ref: "ìš”í•œë³µìŒ 12:26",
        textKo: "ì‚¬ëŒì´ ë‚˜ë¥¼ ì„¬ê¸°ë ¤ë©´ ë‚˜ë¥¼ ë”°ë¥´ë¼.\në‚˜ë¥¼ ë”°ë¥´ëŠ” ê³³ì— ë‚˜ë¥¼ ì„¬ê¸°ëŠ” ìë„ ê±°ê¸° ìˆìœ¼ë¦¬ë‹ˆ\nì‚¬ëŒì´ ë‚˜ë¥¼ ì„¬ê¸°ë©´ ë‚´ ì•„ë²„ì§€ê»˜ì„œ ê·¸ë¥¼ ê·€íˆ ì—¬ê¸°ì‹œë¦¬ë¼."
      }
    ];

    /* ===== 3. ê³µí†µ: ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ë¬¸ì¥ ë¹Œë” ===== */

    function buildKoSentenceAffirm(mode, subj, verb) {
      const s = subj.koTopic;
      if (mode === "present") {
        return `${s} ${verb.koPresentAffirm}.`;
      } else if (mode === "past") {
        return `${s} ${verb.koPastAffirm}.`;
      } else { // future
        return `${s} ${verb.koFutureAffirm}.`;
      }
    }

    function buildKoSentenceNeg(mode, subj, verb) {
      const s = subj.koTopic;
      if (mode === "presentNeg") {
        return `${s} ${verb.koPresentNeg}.`;
      } else if (mode === "pastNeg") {
        return `${s} ${verb.koPastNeg}.`;
      } else { // futureNeg
        return `${s} ${verb.koFutureNeg}.`;
      }
    }

    /* ===== 4. í”Œë˜ì‹œì¹´ë“œ ë Œë” ê³µí†µ ===== */

    function renderFlashCardBlock(parentEl, words, idPrefix) {
      const block = document.createElement("div");
      block.className = "card";
      block.innerHTML = `
        <div class="section-label">ë‹¨ì–´ í”Œë˜ì‹œ ì¹´ë“œ</div>
        <div class="ko">ì¹´ë“œë¥¼ ëˆŒëŸ¬ ì•/ë’·ë©´ì„ ë°”ê¾¸ê³ , í•œìë¥¼ ì†Œë¦¬ ë‚´ì–´ ë”°ë¼ ì½ì–´ ë³´ì•„ìš”.</div>
        <div class="flash-wrapper">
          <button class="arrow-btn" id="${idPrefix}-prev">â—€</button>
          <div class="flashcard" id="${idPrefix}-card">
            <div class="flash-counter" id="${idPrefix}-counter"></div>
            <div class="flash-face" id="${idPrefix}-face"></div>
          </div>
          <button class="arrow-btn" id="${idPrefix}-next">â–¶</button>
        </div>
        <div class="idx-text" id="${idPrefix}-idx"></div>
        <div class="btn-row">
          <button id="${idPrefix}-speak">ë‹¤ì‹œ ë“£ê¸° â–¶</button>
        </div>
      `;
      parentEl.appendChild(block);

      let idx = 0;
      let front = true;

      function draw() {
        const v = words[idx];
        const face = document.getElementById(`${idPrefix}-face`);
        const cnt = document.getElementById(`${idPrefix}-counter`);
        const idxEl = document.getElementById(`${idPrefix}-idx`);
        const cardEl = document.getElementById(`${idPrefix}-card`);

        cnt.textContent = `${idx + 1} / ${words.length}`;
        idxEl.textContent = `${idx + 1} / ${words.length}`;

        if (front) {
          cardEl.classList.remove("back");
          face.innerHTML = `<div class="flash-front">${v.hanzi}</div>`;
          speakChineseOnce(v.hanzi);
        } else {
          cardEl.classList.add("back");
          face.innerHTML = `
            <div class="flash-back-main">${v.meaning}</div>
            <div class="flash-back-sub">${v.hanzi} Â· ${v.pinyin}</div>
          `;
        }
      }

      document.getElementById(`${idPrefix}-card`).onclick = () => {
        front = !front;
        draw();
      };
      document.getElementById(`${idPrefix}-prev`).onclick = () => {
        idx = (idx - 1 + words.length) % words.length;
        front = true;
        draw();
      };
      document.getElementById(`${idPrefix}-next`).onclick = () => {
        idx = (idx + 1) % words.length;
        front = true;
        draw();
      };
      document.getElementById(`${idPrefix}-speak`).onclick = () => {
        speakChineseOnce(words[idx].hanzi);
      };

      draw();
    }

    /* ===== 5. íƒ­1: ì°¬ì–‘ & ë§ì”€ ===== */

    function renderTab1(container) {
      const wrapper = document.createElement("div");
      wrapper.className = "card";
      wrapper.innerHTML = `
        <div class="section-label">8-1 ì°¬ì–‘ê³¼ ë§ì”€</div>
        <div class="sub-mode-row">
          <button class="sub-mode-btn active" id="t1-sent">í•™ìŠµ ë¬¸ì¥</button>
          <button class="sub-mode-btn" id="t1-verse">ë§ì”€ ì¹´ë“œ</button>
          <button class="sub-mode-btn" id="t1-flash">í”Œë˜ì‹œ ì¹´ë“œ</button>
        </div>
        <div id="t1-body"></div>
      `;
      container.appendChild(wrapper);

      const body = document.getElementById("t1-body");
      const btnSent = document.getElementById("t1-sent");
      const btnVerse = document.getElementById("t1-verse");
      const btnFlash = document.getElementById("t1-flash");

      function setActive(btn) {
        [btnSent, btnVerse, btnFlash].forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      }

      function renderSent() {
        clear(body);
        const card = document.createElement("div");
        card.innerHTML = `
          <div class="zh">æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ã€‚</div>
          <div class="pinyin">wÇ’ yÇjÄ«ng juÃ©dÃ¬ng yÃ o gÄ“ncÃ³ng yÄ“sÅ«</div>
          <div class="ko">ë‚˜ëŠ” ì´ë¯¸ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì •í–ˆì–´ìš”!</div>
          <div class="btn-row">
            <button onclick="speakChineseOnce('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£')">í•œë²ˆ ë“£ê¸° â–¶</button>
            <button class="secondary" onclick="speakChineseFive('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£')">ë‹¤ì„¯ ë²ˆ ë“£ê¸° â–¶â–¶</button>
          </div>
          <div class="hint">ì•„ì´ì™€ í•¨ê»˜, â€œë‚˜ëŠ” ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì‹¬í–ˆì–´!â€ ë¼ê³  ì¤‘êµ­ì–´ì™€ í•œêµ­ì–´ë¡œ ê³ ë°±í•´ ë³´ì•„ìš”.</div>
        `;
        body.appendChild(card);
      }

      function renderVerse() {
        clear(body);
        const intro = document.createElement("div");
        intro.className = "card verse-card";
        intro.innerHTML = `
          <div class="verse-ref">ğŸ“– ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ëŠ” ê¸°ì¨</div>
          <div class="verse-text">
ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê² ë‹¤ê³  ê²°ì •í•˜ëŠ” ê²ƒì€
â€˜ë¹›â€™ê³¼ â€˜ìƒëª…ì˜ ê¸¸â€™ì„ ì„ íƒí•˜ëŠ” ê±°ì˜ˆìš”.
          </div>
        `;
        body.appendChild(intro);

        verses8.forEach(v => {
          const c = document.createElement("div");
          c.className = "card verse-card";
          c.innerHTML = `
            <div class="verse-ref">ğŸ“– ${v.ref}</div>
            <div class="verse-text">${v.textKo}</div>
          `;
          body.appendChild(c);
        });
      }

      function renderFlash() {
        clear(body);
        renderFlashCardBlock(body, flashWordsSong8, "t1flash");
      }

      renderSent();

      btnSent.onclick = () => { setActive(btnSent); renderSent(); };
      btnVerse.onclick = () => { setActive(btnVerse); renderVerse(); };
      btnFlash.onclick = () => { setActive(btnFlash); renderFlash(); };
    }

    /* ===== 6. íƒ­2: ì°¬ì–‘ ê°€ì‚¬ ===== */

    function renderTab2(container) {
      const wrapper = document.createElement("div");
      wrapper.className = "card";
      wrapper.innerHTML = `
        <div class="section-label">8-2 ì°¬ì–‘ ë°°ìš°ê¸°</div>
        <div class="sub-mode-row">
          <button class="sub-mode-btn active" id="t2-sent">í•™ìŠµ ë¬¸ì¥</button>
          <button class="sub-mode-btn" id="t2-flash">í”Œë˜ì‹œ ì¹´ë“œ</button>
          <button class="sub-mode-btn" id="t2-verse">ë§ì”€ ì¹´ë“œ</button>
        </div>
        <div id="t2-body"></div>
      `;
      container.appendChild(wrapper);

      const body = document.getElementById("t2-body");
      const btnSent = document.getElementById("t2-sent");
      const btnFlash = document.getElementById("t2-flash");
      const btnVerse = document.getElementById("t2-verse");

      function setActive(btn) {
        [btnSent, btnFlash, btnVerse].forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      }

      function renderSent() {
        clear(body);
        const card = document.createElement("div");
        card.innerHTML = `
          <div class="section-label">ì°¬ì–‘ ê°€ì‚¬ 1</div>
          <div class="zh">æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ã€‚</div>
          <div class="pinyin">wÇ’ yÇjÄ«ng juÃ©dÃ¬ng yÃ o gÄ“ncÃ³ng yÄ“sÅ«</div>
          <div class="ko">ë‚˜ëŠ” ì´ë¯¸ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì •í–ˆì–´ìš”!</div>
          <div class="btn-row">
            <button onclick="speakChineseOnce('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£')">í•œë²ˆ ë“£ê¸° â–¶</button>
            <button class="secondary" onclick="speakChineseFive('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£')">ë‹¤ì„¯ ë²ˆ ë“£ê¸° â–¶â–¶</button>
          </div>

          <div class="section-label" style="margin-top:18px;">ì°¬ì–‘ ê°€ì‚¬ 2</div>
          <div class="zh">æ°¸ä¸å›å¤´ã€‚</div>
          <div class="pinyin">yÇ’ng bÃ¹ huÃ­tÃ³u</div>
          <div class="ko">ì˜ì›íˆ ë’¤ëŒì•„ë³´ì§€ ì•Šì„ ê±°ì˜ˆìš”.</div>
          <div class="btn-row">
            <button onclick="speakChineseOnce('æ°¸ä¸å›å¤´')">í•œë²ˆ ë“£ê¸° â–¶</button>
            <button class="secondary" onclick="speakChineseFive('æ°¸ä¸å›å¤´')">ë‹¤ì„¯ ë²ˆ ë“£ê¸° â–¶â–¶</button>
          </div>

          <div class="hint">â€œæ°¸ä¸å›å¤´â€ëŠ” í•œ ë²ˆë§Œ ì •í™•í•˜ê²Œ ìµíˆê³ , ì—¬ëŸ¬ ë²ˆ ë°˜ë³µí•´ì„œ ë¶ˆëŸ¬ ë³´ì•„ìš”.</div>
        `;
        body.appendChild(card);
      }

      function renderFlash() {
        clear(body);
        renderFlashCardBlock(body, flashWordsSong8, "t2flash");
      }

      function renderVerse() {
        clear(body);
        const c = document.createElement("div");
        c.className = "card verse-card";
        c.innerHTML = `
          <div class="verse-ref">ğŸ“– ê²°ì‹¬ì„ ì§€ì¼œ ì£¼ì‹œëŠ” í•˜ë‚˜ë‹˜</div>
          <div class="verse-text">
ìš°ë¦¬ê°€ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì‹¬í•˜ë©´,
í•˜ë‚˜ë‹˜ê»˜ì„œëŠ” ê·¸ ê²°ì‹¬ì„ ëê¹Œì§€ ë¶™ë“¤ì–´ ì£¼ì‹œëŠ” ë¶„ì´ì„¸ìš”.
          </div>
        `;
        body.appendChild(c);
      }

      renderSent();

      btnSent.onclick = () => { setActive(btnSent); renderSent(); };
      btnFlash.onclick = () => { setActive(btnFlash); renderFlash(); };
      btnVerse.onclick = () => { setActive(btnVerse); renderVerse(); };
    }

    /* ===== 7. ê³µí†µ: A/B ë¬¸ì¥ ë§Œë“¤ê¸° ë¹Œë” ===== */

    function renderSentenceBuilder(bodyEl, mode, prefix) {
      clear(bodyEl);

      const isNeg = mode.includes("Neg");

      const box = document.createElement("div");
      box.className = "card";
      box.innerHTML = `
        <div class="template-box">
          <div class="zh" id="${prefix}-tmpl-zh" style="font-size:34px;"></div>
          <div class="ko" id="${prefix}-tmpl-ko" style="font-size:24px; margin-top:4px;"></div>
        </div>
        <div class="hint">
          <span class="inline-a">A (ë…¸ë‘ ì¹´ë“œ)</span> = ëˆ„ê°€? (ë‚˜, ë„ˆ, ê·¸, ìš°ë¦¬, ë„ˆí¬, ê·¸ë“¤...)<br>
          <span class="inline-b">B (ì´ˆë¡ ì¹´ë“œ)</span> = ë¬´ì—‡ì„ í•˜ë‹ˆ? (ë¨¹ë‹¤, ë§ˆì‹œë‹¤, ë³´ë‹¤, ë“£ë‹¤, ë§í•˜ë‹¤, ë§Œì§€ë‹¤)
        </div>

        <div class="card" style="margin-top:14px; background:#f9fafb;">
          <div class="section-label">â‘  A: ì£¼ì–´ ì„ íƒ</div>
          <div class="mini-card-container" id="${prefix}-subj-wrap"></div>
        </div>

        <div class="card" style="margin-top:10px; background:#f9fafb;">
          <div class="section-label">â‘¡ B: ë™ì‚¬ ì„ íƒ</div>
          <div class="mini-card-container" id="${prefix}-verb-wrap"></div>
        </div>

        <div class="card" style="margin-top:16px;">
          <div class="section-label">ì™„ì„±ëœ ë¬¸ì¥</div>
          <div class="zh" id="${prefix}-out-zh" style="display:none;"></div>
          <div class="pinyin" id="${prefix}-out-py" style="display:none;"></div>
          <div class="ko" id="${prefix}-out-ko" style="display:none; font-size:24px;"></div>
          <div class="btn-row">
            <button class="secondary" id="${prefix}-btn-read">ì¤‘êµ­ì–´ ë‹¤ì‹œ ë“£ê¸° â–¶</button>
          </div>
          <div class="hint" id="${prefix}-status">
            Aì™€ Bë¥¼ ëª¨ë‘ ì„ íƒí•˜ë©´ ë¬¸ì¥ì´ ì™„ì„±ë˜ê³ , ì¤‘êµ­ì–´ê°€ ìë™ìœ¼ë¡œ ì¬ìƒë¼ìš”.
          </div>
        </div>
      `;
      bodyEl.appendChild(box);

      const tmplZhEl = document.getElementById(`${prefix}-tmpl-zh`);
      const tmplKoEl = document.getElementById(`${prefix}-tmpl-ko`);
      const subjWrap = document.getElementById(`${prefix}-subj-wrap`);
      const verbWrap = document.getElementById(`${prefix}-verb-wrap`);
      const outZhEl = document.getElementById(`${prefix}-out-zh`);
      const outPyEl = document.getElementById(`${prefix}-out-py`);
      const outKoEl = document.getElementById(`${prefix}-out-ko`);
      const statusEl = document.getElementById(`${prefix}-status`);

      function setTemplatePlaceholders() {
        if (!isNeg) {
          if (mode === "present") {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span><span class="inline-b">( B )</span>ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> í•´ìš”.`;
          } else if (mode === "past") {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span><span class="inline-b">( B )</span>äº†ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> í–ˆì–´ìš”.`;
          } else {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span>è¦<span class="inline-b">( B )</span>ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> í•  ê±°ì˜ˆìš”.`;
          }
        } else {
          if (mode === "presentNeg") {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span>ä¸<span class="inline-b">( B )</span>ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> ì•ˆ í•´ìš”.`;
          } else if (mode === "pastNeg") {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span>æ²¡<span class="inline-b">( B )</span>ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> ì•ˆ í–ˆì–´ìš”.`;
          } else {
            tmplZhEl.innerHTML = `<span class="inline-a">( A )</span>ä¸è¦<span class="inline-b">( B )</span>ã€‚`;
            tmplKoEl.innerHTML = `<span class="inline-a">( A )</span>ëŠ”(ì€) <span class="inline-b">( B )</span> ì•ˆ í•  ê±°ì˜ˆìš”.`;
          }
        }
      }
      setTemplatePlaceholders();

      let selectedSubj = null;
      let selectedVerb = null;
      let lastZhSentence = "";

      function updateOutput() {
        let aZh = selectedSubj ? selectedSubj.zh : "( A )";
        let aKo = selectedSubj ? selectedSubj.koTopic : "( A )";
        let bZh = selectedVerb ? selectedVerb.hanzi : "( B )";
        let bKo = selectedVerb ? selectedVerb.koBase : "( B )";

        if (!isNeg) {
          if (mode === "present") {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>` +
              `<span class="inline-b">${bZh}</span>ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koPresentAffirm : "( B )"}</span>`;
          } else if (mode === "past") {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>` +
              `<span class="inline-b">${bZh}</span>äº†ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koPastAffirm : "( B )"}</span>`;
          } else {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>è¦` +
              `<span class="inline-b">${bZh}</span>ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koFutureAffirm : "( B )"}</span>`;
          }
        } else {
          if (mode === "presentNeg") {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>ä¸` +
              `<span class="inline-b">${bZh}</span>ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koPresentNeg : "( B )"}</span>`;
          } else if (mode === "pastNeg") {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>æ²¡` +
              `<span class="inline-b">${bZh}</span>ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koPastNeg : "( B )"}</span>`;
          } else {
            tmplZhEl.innerHTML =
              `<span class="inline-a">${aZh}</span>ä¸è¦` +
              `<span class="inline-b">${bZh}</span>ã€‚`;
            tmplKoEl.innerHTML =
              `<span class="inline-a">${aKo}</span> ` +
              `<span class="inline-b">${selectedVerb ? selectedVerb.koFutureNeg : "( B )"}</span>`;
          }
        }

        if (!selectedSubj || !selectedVerb) {
          outZhEl.style.display = "none";
          outPyEl.style.display = "none";
          outKoEl.style.display = "none";
          lastZhSentence = "";
          return;
        }

        let zhSentence = "";
        let pySentence = "";

        if (!isNeg) {
          if (mode === "present") {
            zhSentence = `${selectedSubj.zh}${selectedVerb.hanzi}ã€‚`;
            pySentence = `${selectedSubj.pinyin} ${selectedVerb.pinyin}`;
          } else if (mode === "past") {
            zhSentence = `${selectedSubj.zh}${selectedVerb.hanzi}äº†ã€‚`;
            pySentence = `${selectedSubj.pinyin} ${selectedVerb.pinyin} le`;
          } else {
            zhSentence = `${selectedSubj.zh}è¦${selectedVerb.hanzi}ã€‚`;
            pySentence = `${selectedSubj.pinyin} yÃ o ${selectedVerb.pinyin}`;
          }
        } else {
          if (mode === "presentNeg") {
            zhSentence = `${selectedSubj.zh}ä¸${selectedVerb.hanzi}ã€‚`;
            pySentence = `${selectedSubj.pinyin} bÃ¹ ${selectedVerb.pinyin}`;
          } else if (mode === "pastNeg") {
            zhSentence = `${selectedSubj.zh}æ²¡${selectedVerb.hanzi}ã€‚`;
            pySentence = `${selectedSubj.pinyin} mÃ©i ${selectedVerb.pinyin}`;
          } else {
            zhSentence = `${selectedSubj.zh}ä¸è¦${selectedVerb.hanzi}ã€‚`;
            pySentence = `${selectedSubj.pinyin} bÃº yÃ o ${selectedVerb.pinyin}`;
          }
        }

        const koSentence = !isNeg
          ? buildKoSentenceAffirm(
              mode === "present" ? "present" :
              mode === "past" ? "past" : "future",
              selectedSubj,
              selectedVerb
            )
          : buildKoSentenceNeg(
              mode,
              selectedSubj,
              selectedVerb
            );

        outZhEl.style.display = "block";
        outPyEl.style.display = "block";
        outKoEl.style.display = "block";

        outZhEl.textContent = zhSentence;
        outPyEl.textContent = pySentence;
        outKoEl.textContent = koSentence;

        lastZhSentence = zhSentence;
        speakChineseOnce(zhSentence);
      }

      pronouns8.forEach(p => {
        const c = document.createElement("div");
        c.className = "mini-card mini-card-a";
        c.innerHTML = `
          <div class="mini-card-title">${p.koLabel}</div>
          <div class="mini-card-zh">${p.zh}</div>
          <div class="mini-card-sub">${p.pinyin}</div>
        `;
        c.onclick = () => {
          selectedSubj = p;
          subjWrap.querySelectorAll(".mini-card").forEach(el => {
            el.style.outline = "none";
          });
          c.style.outline = "3px solid #2563eb";
          updateOutput();
        };
        subjWrap.appendChild(c);
      });

      vocabDaily8.forEach(v => {
        const c = document.createElement("div");
        c.className = "mini-card mini-card-b";
        c.innerHTML = `
          <div class="mini-card-title">${v.koBase}</div>
          <div class="mini-card-zh">${v.hanzi}</div>
          <div class="mini-card-sub">${v.pinyin}</div>
        `;
        c.onclick = () => {
          selectedVerb = v;
          verbWrap.querySelectorAll(".mini-card").forEach(el => {
            el.style.outline = "none";
          });
          c.style.outline = "3px solid #22c55e";
          updateOutput();
        };
        verbWrap.appendChild(c);
      });

      document.getElementById(`${prefix}-btn-read`).onclick = () => {
        if (!lastZhSentence) {
          statusEl.textContent = "ë¨¼ì € Aì™€ Bë¥¼ ëª¨ë‘ ê³¨ë¼ì„œ ë¬¸ì¥ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”.";
          return;
        }
        speakChineseOnce(lastZhSentence);
      };
    }

    /* ===== 8. íƒ­3: ë¬¸ì¥ ë§Œë“¤ê¸° (í˜„ì¬ / ê³¼ê±° / ë¯¸ë˜) ===== */

    function renderTab3(container) {
      const wrap = document.createElement("div");
      wrap.className = "card";
      wrap.innerHTML = `
        <div class="section-label">8-3 ë¬¸ì¥ ë§Œë“¤ê¸° (í˜„ì¬ Â· ê³¼ê±° Â· ë¯¸ë˜)</div>
        <div class="sub-mode-row">
          <button class="sub-mode-btn active" id="t3-pres">ë¬¸ì¥ë§Œë“¤ê¸°-í˜„ì¬</button>
          <button class="sub-mode-btn" id="t3-past">ë¬¸ì¥ë§Œë“¤ê¸°-ê³¼ê±°</button>
          <button class="sub-mode-btn" id="t3-fut">ë¬¸ì¥ë§Œë“¤ê¸°-ë¯¸ë˜</button>
        </div>
        <div id="t3-body"></div>
      `;
      container.appendChild(wrap);

      const body = document.getElementById("t3-body");
      const bPres = document.getElementById("t3-pres");
      const bPast = document.getElementById("t3-past");
      const bFut  = document.getElementById("t3-fut");

      function setActive(btn) {
        [bPres, bPast, bFut].forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      }

      function showPres() {
        renderSentenceBuilder(body, "present", "t3-pres");
      }
      function showPast() {
        renderSentenceBuilder(body, "past", "t3-past");
      }
      function showFut() {
        renderSentenceBuilder(body, "future", "t3-fut");
      }

      showPres();

      bPres.onclick = () => { setActive(bPres); showPres(); };
      bPast.onclick = () => { setActive(bPast); showPast(); };
      bFut.onclick  = () => { setActive(bFut);  showFut();  };
    }

    /* ===== 9. íƒ­4: ë¬¸ì¥ ë§Œë“¤ê¸° (ë¶€ì •) ===== */

    function renderTab4(container) {
      const wrap = document.createElement("div");
      wrap.className = "card";
      wrap.innerHTML = `
        <div class="section-label">8-4 ë¬¸ì¥ ë§Œë“¤ê¸° (í˜„ì¬ Â· ê³¼ê±° Â· ë¯¸ë˜ ë¶€ì •)</div>
        <div class="sub-mode-row">
          <button class="sub-mode-btn active" id="t4-presNeg">ë¬¸ì¥ë§Œë“¤ê¸°-í˜„ì¬ë¶€ì •</button>
          <button class="sub-mode-btn" id="t4-pastNeg">ë¬¸ì¥ë§Œë“¤ê¸°-ê³¼ê±°ë¶€ì •</button>
          <button class="sub-mode-btn" id="t4-futNeg">ë¬¸ì¥ë§Œë“¤ê¸°-ë¯¸ë˜ë¶€ì •</button>
        </div>
        <div id="t4-body"></div>
      `;
      container.appendChild(wrap);

      const body = document.getElementById("t4-body");
      const bPres = document.getElementById("t4-presNeg");
      const bPast = document.getElementById("t4-pastNeg");
      const bFut  = document.getElementById("t4-futNeg");

      function setActive(btn) {
        [bPres, bPast, bFut].forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      }

      function showPresNeg() {
        renderSentenceBuilder(body, "presentNeg", "t4-presNeg");
      }
      function showPastNeg() {
        renderSentenceBuilder(body, "pastNeg", "t4-pastNeg");
      }
      function showFutNeg() {
        renderSentenceBuilder(body, "futureNeg", "t4-futNeg");
      }

      showPresNeg();

      bPres.onclick = () => { setActive(bPres); showPresNeg(); };
      bPast.onclick = () => { setActive(bPast); showPastNeg(); };
      bFut.onclick  = () => { setActive(bFut);  showFutNeg();  };
    }

    /* ===== 10. íƒ­5: ë™ì‚¬ ë°”ê¿” ë¶€ë¥´ê¸° ===== */

    function renderTab5(container) {
      const c = document.createElement("div");
      c.className = "card";
      c.innerHTML = `
        <div class="section-label">8-5 ì°¬ì–‘ ì•ˆì˜ ë™ì‚¬ ë°”ê¿” ë¶€ë¥´ê¸°</div>
        <div class="ko">
          ì´ˆë¡ìƒ‰ ë¶€ë¶„ì˜ ë™ì‚¬ë¥¼ ë°”ê¿” ë„£ì–´, ê°™ì€ ë©œë¡œë””ë¡œ ì—¬ëŸ¬ ê³ ë°±ì„ ë§Œë“¤ì–´ ë³´ì•„ìš”.
        </div>
        <div class="template-box">
          <div class="zh">
            æˆ‘å·²ç»å†³å®šè¦
            <span class="inline-b" id="t5-verb-zh">è·Ÿä»</span>
            è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´ã€‚
          </div>
          <div class="pinyin" id="t5-verb-py">
            wÇ’ yÇjÄ«ng juÃ©dÃ¬ng yÃ o gÄ“ncÃ³ng yÄ“sÅ«, yÇ’ng bÃ¹ huÃ­tÃ³u
          </div>
          <div class="ko" id="t5-verb-ko">
            ë‚˜ëŠ” ì´ë¯¸ ì˜ˆìˆ˜ë‹˜ì„ <span class="inline-b">ë”°ë¥´ê¸°ë¡œ</span> ê²°ì •í–ˆì–´ìš”. ì ˆëŒ€ ë’¤ëŒì•„ë³´ì§€ ì•Šì„ ê±°ì˜ˆìš”.
          </div>
        </div>
        <div class="section-label">ë™ì‚¬ ë°”ê¾¸ì–´ ë³´ê¸°</div>
        <div class="mini-card-container" id="t5-verb-wrap"></div>
        <div class="btn-row" style="margin-top:12px;">
          <button onclick="speakChineseOnce('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´')">ì›ë˜ ê°€ì‚¬ ë“£ê¸° â–¶</button>
        </div>
      `;
      container.appendChild(c);

      const verbZhEl = document.getElementById("t5-verb-zh");
      const verbPyEl = document.getElementById("t5-verb-py");
      const verbKoEl = document.getElementById("t5-verb-ko");
      const wrap = document.getElementById("t5-verb-wrap");

      function getKoPhrase(v) {
        if (v.hanzi === "è·Ÿä»") return "ë”°ë¥´ê¸°ë¡œ";
        if (v.hanzi === "èµç¾") return "ì°¬ì–‘í•˜ê¸°ë¡œ";
        if (v.hanzi === "ä¾é ") return "ì˜ì§€í•˜ê¸°ë¡œ";
        if (v.hanzi === "æ­Œé¢‚") return "ì°¬ì–‘í•˜ê¸°ë¡œ";
        if (v.hanzi === "çˆ±")   return "ì‚¬ë‘í•˜ê¸°ë¡œ";
        if (v.hanzi === "æ„Ÿè°¢") return "ê°ì‚¬í•˜ê¸°ë¡œ";
        return v.meaning + "í•˜ê¸°ë¡œ";
      }

      followVerbs8.forEach(v => {
        const card = document.createElement("div");
        card.className = "mini-card mini-card-b";
        card.innerHTML = `
          <div class="mini-card-title">${v.meaning}</div>
          <div class="mini-card-zh">${v.hanzi}</div>
          <div class="mini-card-sub">${v.pinyin}</div>
        `;
        card.onclick = () => {
          wrap.querySelectorAll(".mini-card").forEach(el => {
            el.style.outline = "none";
          });
          card.style.outline = "3px solid #22c55e";

          verbZhEl.textContent = v.hanzi;
          verbPyEl.textContent =
            `wÇ’ yÇjÄ«ng juÃ©dÃ¬ng yÃ o ${v.pinyin} yÄ“sÅ«, yÇ’ng bÃ¹ huÃ­tÃ³u`;
          verbKoEl.innerHTML =
            `ë‚˜ëŠ” ì´ë¯¸ ì˜ˆìˆ˜ë‹˜ì„ <span class="inline-b">${getKoPhrase(v)}</span> ê²°ì •í–ˆì–´ìš”. ì ˆëŒ€ ë’¤ëŒì•„ë³´ì§€ ì•Šì„ ê±°ì˜ˆìš”.`;

          speakChineseOnce(`æˆ‘å·²ç»å†³å®šè¦${v.hanzi}è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´`);
        };
        wrap.appendChild(card);
      });
    }

    /* ===== 11. íƒ­6: ì°¬ì–‘ ë³µìŠµ + ë‹¨ì–´ ë§¤ì¹­ ê²Œì„ ===== */

    function renderTab6(container) {
      // 1) ì°¬ì–‘ ë³µìŠµ ì¹´ë“œ
      const c = document.createElement("div");
      c.className = "card";
      c.innerHTML = `
        <div class="section-label">8-6 ì°¬ì–‘ ë³µìŠµ & ê¸°ë„</div>
        <div class="zh">æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´ã€‚</div>
        <div class="pinyin">wÇ’ yÇjÄ«ng juÃ©dÃ¬ng yÃ o gÄ“ncÃ³ng yÄ“sÅ«, yÇ’ng bÃ¹ huÃ­tÃ³u</div>
        <div class="ko">
ë‚˜ëŠ” ì´ë¯¸ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ ê²°ì •í–ˆì–´ìš”.
ì ˆëŒ€ ë’¤ëŒì•„ë³´ì§€ ì•Šì„ ê±°ì˜ˆìš”.
        </div>
        <div class="btn-row">
          <button onclick="speakChineseOnce('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´')">í•œë²ˆ ë“£ê¸° â–¶</button>
          <button class="secondary" onclick="speakChineseFive('æˆ‘å·²ç»å†³å®šè¦è·Ÿä»è€¶ç¨£ï¼Œæ°¸ä¸å›å¤´')">ë‹¤ì„¯ ë²ˆ ë“£ê¸° â–¶â–¶</button>
        </div>
        <div class="hint" style="margin-top:14px;">
          [ê°ì‚¬ & ê¸°ë„]<br>
          â€œì˜ˆìˆ˜ë‹˜, ì œê°€ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¥´ê¸°ë¡œ í•œ ê²°ì‹¬ì„ ì§€ì¼œ ì£¼ì„¸ìš”.<br>
          ë’¤ëŒì•„ë³´ì§€ ì•Šê³  ëê¹Œì§€ ì˜ˆìˆ˜ë‹˜ì„ ë”°ë¼ê°€ê²Œ í•´ ì£¼ì„¸ìš”.â€
        </div>
      `;
      container.appendChild(c);

      // 2) ë‹¨ì–´ Â· ëœ» ë§¤ì¹­ ê²Œì„ ì¹´ë“œ
      const quizCard = document.createElement("div");
      quizCard.className = "card";
      quizCard.innerHTML = `
        <div class="section-label">8-6 ë‹¨ì–´ Â· ëœ» ë§¤ì¹­ ê²Œì„</div>
        <div class="ko">
          ì™¼ìª½ì˜ ì¤‘êµ­ì–´ ë‹¨ì–´ì™€ ì˜¤ë¥¸ìª½ì˜ ìš°ë¦¬ë§ ëœ»ì„ ì°¨ë¡€ëŒ€ë¡œ ëˆŒëŸ¬ ì§ì„ ë§ì¶° ë³´ì„¸ìš”.<br>
          ì •ë‹µì´ë©´ ì´ˆë¡ìƒ‰ìœ¼ë¡œ ë°”ë€Œê³ , ë°œìŒë„ ë“¤ë ¤ ì¤„ê²Œìš”.
        </div>
        <div class="match-layout">
          <div class="match-col" id="match-left-8"></div>
          <div class="match-col" id="match-right-8"></div>
        </div>
        <div class="hint" id="match-status-8" style="margin-top:12px;"></div>
      `;
      container.appendChild(quizCard);

      const leftEl = document.getElementById("match-left-8");
      const rightEl = document.getElementById("match-right-8");
      const statusEl = document.getElementById("match-status-8");

      // ì™¼ìª½: í•œì / ì˜¤ë¥¸ìª½: ëœ» (ì„ì–´ì„œ)
      const leftItems = flashWordsSong8.map(w => ({
        key: w.hanzi,
        label: w.hanzi
      }));

      // ì˜¤ë¥¸ìª½ì€ ì„ì–´ì„œ
      const rightItemsSource = [...flashWordsSong8];
      rightItemsSource.sort(() => Math.random() - 0.5);
      const rightItems = rightItemsSource.map(w => ({
        key: w.hanzi,
        label: w.meaning
      }));

      let completed = 0;
      const total = leftItems.length;

      leftItems.forEach(item => {
        const btn = document.createElement("button");
        btn.className = "match-btn";
        btn.textContent = item.label;
        btn.dataset.key = item.key;
        btn.onclick = () => {
          if (btn.classList.contains("correct")) return;
          document.querySelectorAll("#match-left-8 .match-btn").forEach(b => b.classList.remove("selected"));
          btn.classList.add("selected");
          statusEl.textContent = "ì´ì œ ì˜¤ë¥¸ìª½ì—ì„œ ëœ»ì„ ê³¨ë¼ ë³´ì„¸ìš”.";
        };
        leftEl.appendChild(btn);
      });

      rightItems.forEach(item => {
        const btn = document.createElement("button");
        btn.className = "match-btn";
        btn.textContent = item.label;
        btn.dataset.key = item.key;
        btn.onclick = () => {
          if (btn.classList.contains("correct")) return;

          const leftSelectedBtn = document.querySelector("#match-left-8 .match-btn.selected");
          if (!leftSelectedBtn) {
            statusEl.textContent = "ë¨¼ì € ì™¼ìª½ ë‹¨ì–´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.";
            return;
          }
          const leftKey = leftSelectedBtn.dataset.key;
          const rightKey = item.key;

          if (leftKey === rightKey) {
            leftSelectedBtn.classList.remove("selected");
            leftSelectedBtn.classList.add("correct");
            btn.classList.add("correct");
            completed++;
            statusEl.textContent = "ì •ë‹µì´ì—ìš”! ğŸ‘";

            speakChineseOnce(leftKey);

            if (completed === total) {
              statusEl.textContent = "ëª¨ë“  ë‹¨ì–´ë¥¼ ë‹¤ ë§ì·„ì–´ìš”! ë„ˆë¬´ ì˜í–ˆì–´ìš” ğŸ‰";
            }
          } else {
            btn.classList.add("wrong");
            statusEl.textContent = "ì¡°ê¸ˆ ì•„ì‰¬ì›Œìš”. ë‹¤ì‹œ í•œ ë²ˆ ë„ì „í•´ ë³´ì!";
            setTimeout(() => {
              btn.classList.remove("wrong");
              if (leftSelectedBtn) leftSelectedBtn.classList.remove("selected");
            }, 600);
          }
        };
        rightEl.appendChild(btn);
      });
    }

    /* ===== 12. ìƒë‹¨ íƒ­ ê´€ë¦¬ ===== */

    const steps8 = [
      { id: "8-1", label: "1" },
      { id: "8-2", label: "2" },
      { id: "8-3", label: "3" },
      { id: "8-4", label: "4" },
      { id: "8-5", label: "5" },
      { id: "8-6", label: "6" }
    ];

    let currentStepId = "8-1";
    const stepTabsEl = document.getElementById("step-tabs");
    const contentEl = document.getElementById("content");

    function renderStepTabs() {
      clear(stepTabsEl);
      steps8.forEach(s => {
        const b = document.createElement("button");
        b.className = "step-tab";
        if (s.id === currentStepId) b.classList.add("active");
        b.textContent = s.label;
        b.onclick = () => {
          currentStepId = s.id;
          renderStepTabs();
          renderContent();
        };
        stepTabsEl.appendChild(b);
      });
    }

    function renderContent() {
      clear(contentEl);
      if (currentStepId === "8-1") renderTab1(contentEl);
      else if (currentStepId === "8-2") renderTab2(contentEl);
      else if (currentStepId === "8-3") renderTab3(contentEl);
      else if (currentStepId === "8-4") renderTab4(contentEl);
      else if (currentStepId === "8-5") renderTab5(contentEl);
      else if (currentStepId === "8-6") renderTab6(contentEl);
    }

    renderStepTabs();
    renderContent();
  </script>
</body>
</html>

